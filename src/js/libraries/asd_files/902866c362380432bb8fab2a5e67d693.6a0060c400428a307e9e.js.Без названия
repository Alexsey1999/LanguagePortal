(window.webpackJsonp=window.webpackJsonp||[]).push([["902866c362380432bb8fab2a5e67d693"],{"/cSr":function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return n}));var i=s("q1tI"),a=(s("17x9"),s("ZxpX"));function n(e){return i.createElement("div",{className:Object(a.classNames)("ChatSettingsRoundedIcon","ChatSettingsRoundedIcon--"+e.type,"ChatSettingsRoundedIcon--"+e.backgroundColor)})}},ZoqV:function(e,t,s){"use strict";s.r(t),s.d(t,"mount",(function(){return be}));var i=s("ofcU"),a=s("q1tI"),n=s("i8i4"),r=(s("HEwt"),s("a1Th"),s("rGqo"),s("rE2o"),s("ioFf"),s("OEbY"),s("VRzm"),s("Btvt"),s("P13b")),o=s("vT4u"),l=s("rDjD"),c=s("6krn"),h=s("aong"),_=s("amDN"),d=s("BiHW"),m=(s("pIFo"),s("ZxpX")),g=s("s0Wt"),p=s("SSU4"),u=s("b8Q7"),C=s("sp2a"),v=s("ERyv"),b=c.default.getLang;class A extends a.PureComponent{constructor(e){super(e),this.onSaveTitle=e=>{var t=this.props.store,s=t.get(),i=e.value.trim().replace("\n","");i&&i!==unclean(this.props.title)&&(this.setState({titleChanged:!1}),t.set(o.updateChatTopic.bind(null,s.peer,i)))},this.onChangeTitle=e=>{if(this.state.title!==e.target.value){var t=e.target.value.replace("\n","");this.setState({title:t,titleChanged:unclean(this.props.title)!==t})}},this.onValidateTitle=e=>!!e.trim().replace("\n",""),this.onCancelTitle=()=>{this.setState({title:unclean(this.props.title),titleChanged:!1})},this.onSaveDescription=e=>{},this.onPhotoUpload=()=>{var e=this.props.store,t=e.get().peer;Object(C.canChangeTitle)(e)&&(cur.recieveCropResult=void 0,Page.ownerPhoto(t,{gid:e.get().gid}))},this.onPhotoRemove=()=>{var e=this.props.store,t=e.get().peer;Object(C.canChangeTitle)(e)&&e.set(o.removeChatPhoto.bind(null,t)).then(()=>e.set(o.getChatDetails.bind(null,t))).catch(e=>Object(v.imWeirdCatch)("onPhotoRemove",e))},this.state={title:unclean(e.title),titleChanged:!1}}getCasperInfo(){var e=b("mail_casper_chat_info");return a.createElement(a.Fragment,null,b("mail_casper_chat_label"),a.createElement(g.default,{text:e,position:"t",appearance:"light",maxWidth:280,marginTop:-6},a.createElement(u.default,{"aria-label":e,className:"ChatSettingsInfo__casperHint"})))}render(){var e=this.props,t=e.store,s=e.photo,i=e.title,n=e.description,r=e.grid,o=e.meta,l=e.isDefaultPhotoOwner,c=void 0!==l&&l,h=e.isCasper,_=void 0!==h&&h,d=unclean(i),u=Object(C.canChangeTitle)(t),v=Object(m.classNames)("ChatSettingsInfo",{"ChatSettingsInfo--editable":u}),A=Object(m.classNames)("ChatSettingsInfo__title",{"ChatSettingsInfo__title-service":64&this.props.flags});return a.createElement("div",{className:v},a.createElement("header",{className:"ChatSettingsInfo__header"},a.createElement("div",{className:"ChatSettingsInfo__photo"},a.createElement("div",{className:"ChatSettingsInfo__attach nim-peer nim-peer_larger","data-tip":b("mail_settings_photo"),onClick:this.onPhotoUpload},s?a.createElement("img",{src:s,width:"80",height:"80",alt:d,className:"ChatSettingsInfo__photoSelf"}):a.createElement("div",{className:"nim-peer--photo-w"},a.createElement("div",{className:"ChatSettingsInfo__photoGrid nim-peer--photo",dangerouslySetInnerHTML:{__html:r}}))),s&&u&&!c&&a.createElement(g.default,{text:b("mail_settings_remove_photo"),position:"t",align:"left"},a.createElement("button",{onClick:this.onPhotoRemove,className:"ChatSettingsInfo__photoRemove"}))),a.createElement("h3",{className:A},u?a.createElement(p.default,{value:this.state.title,changed:this.state.titleChanged,useEnter:!0,onSave:this.onSaveTitle,onChange:this.onChangeTitle,onCancel:this.onCancelTitle,validate:this.onValidateTitle}):d),a.createElement("div",{className:"ChatSettingsInfo__meta"},a.createElement("span",{className:"ChatSettingsInfo__metaItem"},o),_&&a.createElement("span",{className:"ChatSettingsInfo__metaItem"},this.getCasperInfo()))),n&&a.createElement("div",{className:"ChatSettingsInfo__description"},u?a.createElement(p.default,{value:n,onSave:this.onSaveDescription}):n))}}s("KKXr");var S=s("h7Kf"),N=s("zgoX"),f=s("n3cE"),I=s("ngxX"),L=c.default.getLang;class E extends a.Component{constructor(e){super(e),this.onCopy=()=>{this.input&&(elfocus(this.input,0,this.input.value.length),document.execCommand("copy"),this.setState({copied:!0}))},this.onBlinkTextHide=()=>{this.setState({copied:!1})},this.getInputRef=e=>{e&&e.element&&(this.input=e.element)},this.state={copied:!1}}componentDidMount(){this.input&&elfocus(this.input,0,this.input.value.length)}render(){var e=this.props,t=e.onReset,s=e.invitationLinks,i=e.store,n=L("mail_invite_link_reset_explainer").split("{reset_link}"),o=!Object(r.isFvkcomgroup)(i,i.get().peer),l=s.linkWithHistory,c=s.linkWithoutHistory,h=this.props.isInvitationLinkWithHistory?l:c;return a.createElement("div",{className:"ChatSettingsInvitationLink"},this.props.reseted&&a.createElement("div",{className:"ChatSettingsInvitationLink__reseted"},L("mail_invite_link_reseted_explainer")),a.createElement("p",null,L("mail_invite_link_explainer")),a.createElement("div",{className:"ChatSettingsInvitationLink__switch"},a.createElement(I.default,{children:L("mail_im_chat_add_members_show_history"),checked:this.props.isInvitationLinkWithHistory,onChange:this.props.onLinkHistoryOptionToggle})),a.createElement("div",{className:"ChatSettingsInvitationLink__main"},a.createElement(S.default,{ref:this.getInputRef,readOnly:"readonly",className:"ChatSettingsInvitationLink__input",value:h}),a.createElement(d.default,{onClick:this.onCopy},L("mail_get_invite_link_copy")),a.createElement(N.default,{className:"ChatSettingsInvitationLink__copied",shown:this.state.copied,callback:this.onBlinkTextHide},L("mail_invite_link_copied"))),o&&a.createElement("p",null,n[0],a.createElement(f.default,{className:"ChatSettingsInvitationLink__reset",onClick:t},L("mail_invite_reset_link")),n[1]))}}var M=s("WfnU"),k=s("0MTP"),O=c.default.getLang;class T extends a.Component{constructor(e){super(e),this.onConfirm=()=>{this.state.loading||(this.setState({loading:!0}),this.props.onConfirm().then(()=>{this.setState({loading:!1}),this.props.onCancel()}).catch(()=>this.setState({loading:!1})))},this.state={}}render(){return a.createElement("div",{className:"ChatSettingsResetInvitationLink"},a.createElement("div",{className:"ChatSettingsResetInvitationLink__text",dangerouslySetInnerHTML:{__html:O("mail_chat_reset_link_warning")}}),a.createElement(k.default,{alignment:"right"},a.createElement(d.default,{appearance:"tertiary",onClick:this.props.onCancel},O("global_cancel")),a.createElement(M.default,{onClick:this.onConfirm,loading:this.state.loading},O("mail_chat_reset_link_confirm"))))}}s("91GP");var y=s("p9ed"),w=s("5R8M"),H=s("Hri0"),F=s("hN/p"),P=s("+tmx"),j=s("/cSr"),R=s("rHUl"),D=c.default.getLang,x=()=>[{label:D("mail_settings_time_one_hour"),value:P.HOUR},{label:D("mail_settings_time_eight_hours"),value:8*P.HOUR},{label:D("mail_settings_time_day"),value:P.DAY},{label:D("mail_settings_time_week"),value:P.WEEK},{label:D("mail_settings_time_forever"),value:-1}];class W extends a.Component{constructor(e){super(e),this.onCopyInviteLink=e=>{this.input&&(this.input.focus(),this.input.select(),document.execCommand("copy"),this.setState({copied:!0})),e.preventDefault(),e.stopPropagation()},this.onBlinkTextHide=()=>{this.setState({copied:!1})},this.getHiddenInput=e=>{this.input=e},this.onDisabledSettingsChange=e=>{var t=e.selected.value,s=t>0?Math.floor((Date.now()+t)/1e3):t,i=0!==s;this.setState({push_disabled_until:s,push_disabled:i,disabledPlaceholder:this.getDisabledPlaceholder(s)},()=>{this.props.onUpdateNotificationSettings(i,Math.floor(t/1e3)).then(()=>{this.props.afterDisableUntilUpdated()})})},this.onMentionSettingsChange=e=>{var t=e.selected.value;this.setState({mentions_push_disabled:t},()=>{this.props.onUpdateMentionNotificationSettings(t).then(()=>{this.props.afterNotificationSettingsUpdated()})})},this.onShowInviteLink=()=>{Object(C.canChangeInviteLink)(this.props.store)&&this.props.showInvitationLink()};var t=this.getPushSettingsFromProps(e),s=t.push_disabled_until,i=s>0?+new Date(s):s;this.state=Object.assign({pushDisabled:s,disabledPlaceholder:this.getDisabledPlaceholder(i),copied:!1},t)}getPushSettingsFromProps(e){var t=e.store.get();return t.tabs[t.peer].notifications}getPushDisabledFromProps(e){var t=e.store.get();return t.tabs[t.peer].notifications.push_disabled}getDisabledPlaceholder(e){if(!e||0===e)return D("mail_settings_configure");if(-1===e)return D("mail_settings_time_forever");var t=getShortDateWithTime(e,0,!1);return`${D("mail_settings_until")} ${t}`}getDisabledOptions(){return this.state.push_disabled_until?[].concat(x(),[{label:D("mail_settings_time_cancel"),value:0}]):x()}render(){var e=this.props,t=e.store,s=e.flagsUpdated,i=e.notificationSettingsUpdated,n=e.disableUntilUpdated,o=e.onHideStatus,l=e.invitationLinks,c=e.isInvitationLinkWithHistory,h=t.get(),_=h.tabs[h.peer],d=Object(r.isFvkcomgroup)(h,h.peer),g=Object(R.isCommunityChat)(h,h.peer),p=_.inviteLinks&&Object(C.canSeeInviteLink)(t)||Object(C.canChangeInviteLink)(t),u=l||_.inviteLinks,v=u&&(c?u.linkWithHistory:u.linkWithoutHistory),b=Object(C.canSeeSettingsItem)(t,h.peer,h.id),A=Object(m.classNames)("ChatSettingsMenu",{"ChatSettingsMenu--copied":this.state.copied}),S=h.isMassMentionsMessageAllowed,I=D(c?"mail_get_invite_link_copy_with_history":"mail_get_invite_link_copy_without_history");return a.createElement("div",{className:"ChatSettings__pane"},g&&a.createElement(y.default,{className:A},a.createElement(w.default,{onClick:e=>nav.go(_.owner.link,e),chevron:!0,className:"ChatSettingsMenu__owner"},a.createElement(H.default,{size:"28",title:_.owner.title,photo:_.owner.photo,href:_.owner.link,description:_.owner.description}))),a.createElement(y.default,{className:A},a.createElement(w.default,{onClick:this.props.showAttachments,chevron:!0},a.createElement(j.default,{type:"attach",backgroundColor:"blue"}),D("mail_im_show_media_history"))),a.createElement(y.default,{className:A},S&&a.createElement(a.Fragment,null,a.createElement(w.default,{selectable:!1,chevron:!1,aside:a.createElement(a.Fragment,null,a.createElement(N.default,{shown:i,callback:o},D("global_changes_saved_short")),a.createElement(F.default,{className:"ChatSettingsMenu__select",onChange:this.onMentionSettingsChange,options:[{label:D("mail_settings_mentions_all"),value:0},{label:D("mail_settings_mentions_except"),value:1},{label:D("mail_settings_mentions_disable"),value:2}],value:this.state.mentions_push_disabled}))},a.createElement(j.default,{type:"mention",backgroundColor:"blue"}),D("mail_settings_mentions")),a.createElement(w.default,{selectable:!1,aside:a.createElement(a.Fragment,null,a.createElement(N.default,{shown:n,callback:o},D("global_changes_saved_short")),a.createElement(F.default,{className:"ChatSettingsMenu__select",onChange:this.onDisabledSettingsChange,options:this.getDisabledOptions(),placeholder:this.state.disabledPlaceholder}))},a.createElement(j.default,{type:"notice",backgroundColor:"red"}),D("mail_settings_notices"))),(p||b)&&a.createElement(a.Fragment,null,p&&a.createElement(w.default,{onClick:this.onShowInviteLink,chevron:Object(C.canChangeInviteLink)(t)},a.createElement(j.default,{type:"link",backgroundColor:"green"}),D(d?"mail_vkcomgroup_invite_link":"mail_chat_invite_link"),v&&a.createElement("span",{className:"ChatSettingsMenu__invite"},a.createElement("span",{className:"ChatSettingsMenu__hidden"},a.createElement("input",{type:"text",readOnly:!0,value:v,ref:this.getHiddenInput})),a.createElement(N.default,{className:"ChatSettingsMenu__copied",shown:this.state.copied,callback:this.onBlinkTextHide},D("mail_invite_link_copied")),a.createElement(f.default,{className:"ChatSettingsMenu__copy",onClick:this.onCopyInviteLink},I))),b&&a.createElement(w.default,{onClick:this.props.showSettings,chevron:!0,aside:a.createElement(N.default,{shown:s,callback:o},D("global_changes_saved"))},a.createElement(j.default,{type:"gear",backgroundColor:"gray"}),D("mail_settings_options")))))}}s("OG14"),s("Vd3H");var G=s("rudk"),U=s("RlRI"),Y=s("yuXj"),B=s("zjLC"),V=s("kxld");var q=c.default.getLang;class K extends a.Component{constructor(){super(...arguments),this.toggleAdmin=()=>{var e=this.props,t=e.store,s=e.mid,i=e.adminMap,a=t.get().peer,n=!i[s];t.set(o.toggleAdminOptimisticly.bind(null,a,s,n)),t.set(o.toggleAdmin.bind(null,a,s,n))},this.kick=()=>{var e=this.props.store,t=e.get().peer,s=this.props.mid;e.set(e=>function(e,t,s){var i=Object(V.getTab)(e,t);return!i||Object(G.isChatPeer)(t)?Promise.reject("No chat info"):(i.memberIds=i.memberIds.filter((function(e){return e!==s})),i.adminIds=i.adminIds.filter((function(e){return e!==s})),i.membersCount=i.memberIds.length,Promise.resolve(e))}(e,t,s)),e.set(e=>Object(B.kickUserAction)(e,t,s)).catch(e=>{Object(v.imWeirdCatch)("ChatSettingsMemberEdit.kick",e)})},this.cancelMessageRequest=()=>{var e=this.props.store,t=e.get().peer,s=this.props.mid;e.set(e=>Object(B.cancelMessageRequestAction)(e,t,s)).catch(e=>{Object(v.imWeirdCatch)("ChatSettingsMemberEdit.cancel",e)})},this.changeAccess=e=>{var t=this.props.store,s=t.get().peer,i=this.props.mid;t.set(o.changeCommunityAccess.bind(null,s,i,!e)).catch(e=>{Object(v.imWeirdCatch)("ChatSettingsMemberEdit.changeAccess",e)})}}getMemberRole(e,t){var s=this.props.storeData,i=s.peer;return t===s.tabs[i].ownerId?q("mail_settings_owner"):e[t]?q("mail_settings_admin"):null}getActions(e){var t=this.props,s=t.store,i=t.mid,a=Object(h.unpackStore)(s),n=a.id,r=a.peer,o=n===i,l=[],c=Object(R.isCommunityChat)(s,r);if(o)return c&&Object(R.isCommunityInterface)(s)?[]:[{text:q("mail_leave_chat"),onClick:this.props.onLeave}];if(Object(C.canAddAdmin)(s,i)&&l.push({text:e[i]?q("mail_chat_remove_admin"):q("mail_settings_appoint_admin"),onClick:this.toggleAdmin}),Object(C.canKickUser)(s,i)&&l.push({text:q("mail_settings_kick"),onClick:this.kick}),Object(R.isCommunityPeer)(i)&&!e[i]){var _=Object(C.canSeeAllMessages)(s,s.get().peer,i),d=_?"mail_settings_community_mentions_only":"mail_settings_community_full_access";l.push({text:q(d),onClick:this.changeAccess.bind(this,_)})}return l}render(){var e=this.props,t=e.adminMap,s=e.storeData,i=e.mid,n=e.isMR,r=s.id,o=!!t[r],l=this.getMemberRole(t,i),c=r===i,h=o&&this.getActions(t);return n?a.createElement(g.default,{text:q("mail_cancel_invitation"),position:"t",align:"right"},a.createElement("span",{onClick:this.cancelMessageRequest,className:"ChatSettingsMembersEdit__kick"})):a.createElement(a.Fragment,null,l&&a.createElement("span",{className:"ChatSettingsMembersEdit__role"},l),h&&h.length>0&&a.createElement(Y.default,{position:"b",align:"right",trigger:"hover",marginTop:-8,marginLeft:1,data:this.getActions(t)},a.createElement("span",{className:"ChatSettingsMembersEdit__actions"})),!o&&!c&&Object(C.canKickUser)(s,i)&&a.createElement(g.default,{text:q("mail_settings_kick"),position:"t",align:"right"},a.createElement("span",{onClick:this.kick,className:"ChatSettingsMembersEdit__kick"})),!o&&c&&a.createElement(g.default,{text:q("mail_leave_chat"),position:"t",align:"right"},a.createElement("span",{onClick:this.props.onLeave,className:"ChatSettingsMembersEdit__kick"})))}}var Q=s("Aegd"),X={appendParentCls:"ChatSettingsWrapper"},z=c.default.getLang,Z={all:"allShowMore",admins:"adminsShowMore",invitedByMRShowMore:"invitedByMRShowMore"};class $ extends a.Component{constructor(e){super(e),this.onToggleSearch=()=>{this.state.showSearch?this.setState({showSearch:!1,searchQuery:""}):(this.setState({showSearch:!0}),requestAnimationFrame(()=>{this.searchInput.focus()}))},this.onSearchChange=e=>{e.target.value!==this.state.searchQuery&&this.setState({searchQuery:e.target.value})},this.onShowMore=()=>{var e=Z[this.state.current];this.state[e]&&this.setState({[e]:!1})},this.onTabClick=(e,t)=>{e.preventDefault(),this.state.current!==t&&this.setState({current:t})},this.handleDocumentClick=e=>{!this.state.showSearch||this.state.searchQuery||e.target.closest(".ChatSettingsMembersWidget__search")||e.target.closest(".ChatSettingsMembersWidget__searchIcon")||this.setState({showSearch:!1})},this.onKeydown=e=>{this.state.showSearch&&27===e.keyCode&&(this.searchInput.blur(),this.setState({showSearch:!1,searchQuery:""}),e.preventDefault(),e.stopPropagation())},this.getInviter=e=>{if(this.invitersCache[e])return this.invitersCache[e];var t=this.props.store.get(),s=t.peer,i=t.tabs[s],a=i.inviters;if(!a[e])return"";var n=Object(r.getChatMembersByIds)(t,[a[e][0]])[0],o=getSmDate(a[e][2],t.timeshift,!0);if(Object(C.isUserOwnerInChat)(i,e))return this.invitersCache[e]=z("mail_settings_owner"),z("mail_settings_owner");if(!n)return this.invitersCache[e]=o,o;var l=langSex(a[e][1],z("mail_chat_member_invited_by_X","raw")).replace(/{inviter}/,replaceEntities(n.name))+" "+o;return this.invitersCache[e]=l,l},this.isAddMemberWidgetShown=()=>{var e=this.props.store,t=Object(h.unpackStore)(e),s=t.id,i=t.peer,a=this.state,n=a.current,r=a.showSearch,o=a.searchQuery;return"all"===n&&!(r&&""!==o)&&Object(C.canInviteUser)(e,i,s)},this.getCommunityDescriptionText=e=>z(e?"mail_settings_community":"mail_settings_bot"),this.getMemberDescriptionText=(e,t,s)=>{var i=t.tabs[t.peer];if(Object(r.isCommunityPeer)(e.id))return this.getCommunityDescriptionText(e.id===i.ownerId);if(s)return Object(r.getMessageRequestDateText)(e.date,t.timeshift);var a=i.membersLastSeen;return a&&a[e.id]?Object(r.getLastSeenText)(t,e.id,a[e.id],X):void 0},this.searchInputRef=e=>{this.searchInput=e};var t=e.store.get(),s=this.getMembers(t),i=this.getAdmins(t),a=this.getInvitedByMessageRequests(t);this.state={showSearch:!1,searchQuery:"",current:"all",all:s,allShowMore:s.length>50,admins:i,adminsShowMore:i.length>50,invitedByMR:a,invitedByMRShowMore:a.length>50},this.membersMap=s.reduce((e,t)=>(e[t]=!0,e),{}),this.searchIndexPromise=this.getSearchIndex(s).then(e=>{this.searchIndex=e}),this.invitersCache={}}componentWillReceiveProps(e){var t=e.store.get(),s=this.getMembers(t),i=this.getAdmins(t),a=this.getInvitedByMessageRequests(t),n={removes:[],additions:[]},r=s.reduce((e,t)=>(e[t]=!0,e),{});s.forEach(e=>{this.membersMap[e]||n.additions.push(e)}),Object.keys(this.membersMap).forEach(e=>{r[e]||n.removes.push(e)}),(n.removes.length||n.additions.length)&&(this.updateSearchIndex(t,n),this.membersMap=r);var o={all:s,allShowMore:this.state.allShowMore&&s.length>50,admins:i,adminsShowMore:this.state.adminsShowMore&&i.length>50,invitedByMR:a,invitedByMRShowMore:this.state.invitedByMRShowMore&&a.length>50};o.current=o[this.state.current].length>0?this.state.current:"all",this.setState(o)}getMembers(e){var t=e.peer,s=e.tabs[t],i=-1!==(s.memberIds||[]).indexOf(s.ownerId),a=(s.adminIds||[]).reduce((e,t)=>(e[t]=!0,e),{});return(i?[s.ownerId]:[]).concat((s.adminIds||[]).filter(e=>e!==s.ownerId),(s.memberIds||[]).filter(e=>e!==s.ownerId&&!a[e]))}getAdmins(e){var t=e.peer,s=e.tabs[t];return(-1!==(s.memberIds||[]).indexOf(s.ownerId)?[s.ownerId]:[]).concat((s.adminIds||[]).filter(e=>e!==s.ownerId))}getInvitedByMessageRequests(e){var t=e.peer;return e.tabs[t].invitedByMessageRequest.sort((function(e,t){return e.date-t.date}))}getCurrentList(){var e=this.props.store,t=this.state,s=t.current,i=t.showSearch,a=t.searchQuery,n=t.invitedByMR;if(i&&a&&this.searchIndex){var o=n.filter(e=>!!e.name.toLowerCase().trim().split(/\s+/).find(e=>0===e.indexOf(a.toLowerCase())));return this.searchIndex.search(a).concat(o)}var l=this.state[s],c="invitedByMR"===s?l:Object(r.getChatMembersByIds)(e.get(),l);return this.state[s+"ShowMore"]?c.slice(0,50):c}getSearchIndex(e){var t=window.vkIndexer,s=Object(r.getChatMembersByIds)(this.props.store.get(),e);return this.membersMap=s.reduce((e,t)=>(e[t.id]=!0,e),{}),new Promise((e,i)=>{var a=new t(s,e=>e.name,()=>{e(a)})})}updateSearchIndex(e,t){var s=Object(r.getChatMembersByIds)(e,t.removes),i=Object(r.getChatMembersByIds)(e,t.additions);(this.searchIndex?Promise.resolve(this.searchIndex):this.searchIndexPromise).then(e=>{s.forEach(t=>{e.remove(t)}),i.forEach(t=>{e.add(t)})})}componentDidMount(){this.searchInput.addEventListener("keydown",this.onKeydown)}componentWillUnmount(){this.searchInput.removeEventListener("keydown",this.onKeydown)}render(){var e=this.props,t=e.store,s=e.membersCount,i=e.membersAdded,n=e.onHideStatus,o=this.state,l=o.current,c=o.showSearch,h=o.searchQuery,_=o.admins,d=o.invitedByMR,g=t.get(),p=g.peer,u=g.tabs[p],C=this.getCurrentList(),v=this.isAddMemberWidgetShown()?["add"].concat(C):C,b=this.state[Z[l]],A={"ChatSettingsMembersWidget--search":!!c},S=u.adminIds.reduce((e,t)=>(e[t]=!0,e),{});return a.createElement("div",{className:Object(m.classNames)("ChatSettingsMembersWidget",A)},a.createElement("header",{className:"ChatSettingsMembersWidget__header"},a.createElement("input",{placeholder:z("mail_members_search"),className:"ChatSettingsMembersWidget__search",onChange:this.onSearchChange,onInput:this.onSearchChange,onPaste:this.onSearchChange,value:this.state.searchQuery,ref:this.searchInputRef}),a.createElement("button",{className:"ChatSettingsMembersWidget__searchIcon",onClick:this.onToggleSearch}),a.createElement(U.default,{className:"ChatSettingsMembersWidget__tabs",onTabClick:this.onTabClick},a.createElement("span",{key:"all"},z("mail_settings_everyone")+" ",a.createElement("span",{className:"Tabs__desc"},Object(r.getAliveMembersCount)(u))),_.length>0&&a.createElement("span",{key:"admins"},z("mail_settings_admins")+" ",a.createElement("span",{className:"Tabs__desc"},_.length)),d.length>0&&a.createElement("span",{key:"invitedByMR"},z("mail_invited_members")+" ",a.createElement("span",{className:"Tabs__desc"},d.length)))),a.createElement("div",{className:"ChatSettingsMembersWidget__list"},a.createElement(y.default,{border:!1},v.length>0&&v.map(e=>{if("add"===e)return a.createElement(w.default,{selectable:!1,border:!1,key:"add",onClick:this.props.showMembersSettings,aside:a.createElement(N.default,{className:"ChatSettingsMembersWidget__blink",shown:i,callback:n},langNumeric(s||0,z("mail_settings_members_added","raw")))},a.createElement("span",{className:"ChatSettingsMembersWidget__add"},a.createElement("span",null,z("mail_settings_add_members"))));var o=this.getInviter(e.id),c="invitedByMR"===l,h=e.image_status?e.name+`<span class="ChatSettingsMembersWidget__imageStatus">${e.image_status}</span>`:e.name,_=this.getMemberDescriptionText(e,g,c);return a.createElement(w.default,{selectable:!1,border:!1,aside:a.createElement(K,{adminMap:S,store:t,storeData:g,mid:e.id,onLeave:this.props.onLeave,isMR:c}),key:e.id},a.createElement(H.default,{photo:Object(G.isContactPeer)(e.id)?a.createElement(Q.ConversationNoPhoto,{id:p,text:Object(r.getUserInitials)(e.name),size:"xxxs",specificType:7}):e.photo,title:h,description:a.createElement("span",{title:o,dangerouslySetInnerHTML:{__html:_}}),href:e.link}))}),!v.length&&c&&h&&a.createElement("div",{className:"ChatSettingsMembersWidget__empty"},z("mail_settings_not_found")),!(c&&h)&&b&&a.createElement("div",{className:"ChatSettingsMembersWidget__more",onClick:this.onShowMore},z("mail_settings_show_all_members")))))}}var J=s("F0+T"),ee=s("wQFj"),te=s("EasH"),se=s("DM26"),ie=c.default.getLang,ae=()=>{};class ne extends a.Component{constructor(e){super(e),this.onChange=e=>{var t=this.props.store.get(),s=e.target.value;Object(o.searchLocalHints)(s,t).then(e=>(this.setSearchResults({},!1,s,e),s?(this.isSearching=!0,this.serverSearch(s,e.map(e=>e.peerId))):Promise.resolve([]))).then(this.appendSearchResults).catch(()=>{})},this.serverSearch=Object(se.debouncedPromise)((e,t)=>{var s=this.props.store;return Object(o.searchHints)(e,t,"friends",s.get())},300),this.onRemoveToken=e=>new Promise(t=>{var s=this.state.selected.filter(t=>t!==e);this.selected=s.reduce((e,t)=>(e[t]=!0,e),{}),this.setState({selected:s},t)}),this.onSelect=e=>new Promise(t=>{var s=this.selected[e]?this.state.selected.filter(t=>t!==e):[].concat(this.state.selected,e).filter((e,t,s)=>s.indexOf(e)===t);this.selected=s.reduce((e,t)=>(e[t]=!0,e),{}),this.resetSearch({selected:s,value:""},t)}),this.onShowHistoryToggle=()=>{this.setState({isShowHistoryChecked:!this.state.isShowHistoryChecked})},this.onAddPeople=()=>{var e=this.props.store,t=e.get().peer,s=this.state.selected.map(e=>parseInt(e)),i=this.state.isShowHistoryChecked;this.setState({loading:!0}),e.set(o.addNewMember.bind(null,t,s,i)).then(()=>e.set(o.getChatDetails.bind(null,t)).then(()=>{this.selected={},this.resetSearch({selected:[],loading:!1},()=>{this.props.afterSave(s.length)})})).catch(e=>{this.selected={},this.resetSearch({selected:[],loading:!1}),Object(te.showFastBox)(ie("global_error"),e)})},this.setSearchResults=(e,t,s,i)=>{var a=this.props.store.get(),n=Object(R.getTab)(a,a.peer),r=[];i.forEach(e=>{this.data[e.peerId]||(this.data[e.peerId]=e),-1===n.memberIds.indexOf(e.peerId)&&r.push(e.peerId)}),this.setState(Object.assign({},e,{found:r,value:s}),t||ae)},this.appendSearchResults=e=>{var t=this.props.store.get(),s=Object(R.getTab)(t,t.peer),i=this.state.found;e.forEach(e=>{this.data[e.peerId]||(this.data[e.peerId]=e),-1===s.memberIds.indexOf(e.peerId)&&-1===i.indexOf(e.peerId)&&i.push(e.peerId)}),this.isSearching=!1,this.setState({found:i})},this.state={selected:[],value:"",loading:!1,found:[],isShowHistoryChecked:!0},this.data={},this.selected={}}resetSearch(e,t){return Object(o.searchLocalHints)("",this.props.store.get()).then(this.setSearchResults.bind(this,e,t,""))}componentDidMount(){this.resetSearch()}render(){var e=Object.keys(this.state.selected).length;return a.createElement("div",{className:"ChatSettingsMembers"},a.createElement(J.default,{className:"ChatSettingsMembers__multiSelect",tokens:this.state.selected.map(e=>({text:unclean(this.data[e].name),id:e})),removeTokenPlaceholder:ie("mail_create_chat_remove_user"),onRemoveToken:this.onRemoveToken,placeholder:ie("mail_search_creation"),value:this.state.value,onChange:this.onChange,onSelect:this.onSelect,useInfiniteScroll:!1,hasMore:!1,virtualized:!1,loadMore:()=>{},notFoundText:ie("mail_not_found"),autoFocus:!0,isSearching:this.isSearching},this.state.found.map(e=>a.createElement("div",{className:Object(m.classNames)("ChatSettingsMembers__entity",{"ChatSettingsMembers__entity--selected":this.selected[e]}),key:e,"data-id":e},a.createElement(H.default,{size:"34",title:this.data[e].name,photo:this.data[e].photo})))),a.createElement(k.default,{alignment:"right",className:"ChatSettingsMembers__submitArea"},a.createElement(ee.default,{checked:this.state.isShowHistoryChecked,onChange:this.onShowHistoryToggle,className:"ChatSettingsMembers__showHistory"},ie("mail_im_chat_add_members_show_history")),a.createElement(M.default,{disabled:0===e,onClick:this.onAddPeople,loading:this.state.loading,className:"ChatSettingsMembers__confirm"},ie(e<2?"mail_append_chat":"mail_im_create_chat_with"))))}}var re=s("iukX"),oe=s("ftTi");function le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var s=[],i=!0,a=!1,n=void 0;try{for(var r,o=e[Symbol.iterator]();!(i=(r=o.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){a=!0,n=e}finally{try{i||null==o.return||o.return()}finally{if(a)throw n}}return s}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ce(e,t);var s=Object.prototype.toString.call(e).slice(8,-1);"Object"===s&&e.constructor&&(s=e.constructor.name);if("Map"===s||"Set"===s)return Array.from(s);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return ce(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var s=0,i=new Array(t);s<t;s++)i[s]=e[s];return i}var he,_e=c.default.getLang;class de extends a.Component{constructor(e){super(e),this.showInvitationLink=()=>{var e=this.props.store,t=Object(h.unpackStore)(e),s=t.peer;return this.setState({invitationLoading:!0}),Object(o.getInviteLink)(s-2e9,t).then(e=>{var t=le(e,1)[0];this.setState({section:2,invitationLoading:!1,invitationLinks:t})})},this.onUpdateNotificationSettings=(e,t)=>{var s=this.props,i=s.store,a=s.parentMutations,n=i.get().peer;return i.set(o.toggleMutePeer.bind(null,n,e,t)).then(a().updateState.bind(null,n))},this.onUpdateMentionNotificationSettings=e=>{var t=this.props,s=t.store,i=t.parentMutations,a=s.get().peer;return s.set(o.toggleMuteMentionsPeer.bind(null,a,e)).then(i().updateState.bind(null,a))},this.onUpdateFlags=e=>{var t=this.props.store.get(),s=t.peer,i=t.hasOwnProperty("onUpdateFlags")?t.onUpdateFlags.bind(null,s,e):e=>Promise.resolve(e);return Object(o.updateFlags)(s,e,t).then(i)},this.afterFlagsUpdated=()=>{this.go(0,()=>this.setBlinkStatus({flagsUpdated:!0}))},this.afterMembersAdded=e=>{this.go(0,()=>this.setBlinkStatus({membersAdded:!0,membersCount:e}))},this.afterNotificationSettingsUpdated=()=>{this.setBlinkStatus({notificationSettingsUpdated:!0})},this.afterDisableUntilUpdated=()=>{this.setBlinkStatus({disableUntilUpdated:!0})},this.setBlinkStatus=e=>{this.timers.push(setTimeout(()=>this.setState(e),300))},this.onHideStatus=()=>{this.setState({membersAdded:!1,flagsUpdated:!1,notificationSettingsUpdated:!1,disableUntilUpdated:!1})},this.onLeave=()=>{var e=this.props,t=e.store,s=e.closePopup,i=t.get().peer,a=Object(r.isFvkcomgroup)(t,i),n=Object(te.showFastBox)({title:_e(a?"mail_leave_channel":"mail_chat_leave_title"),dark:1},_e(a?"mail_vkcomgroup_leave_confirm":"mail_chat_leave_confirm"),_e(a?"mail_leave_channel":"mail_leave_chat"),(function(){t.set(o.unpinMessageOptimistic.bind(null,i)),t.set(o.leaveChat.bind(null,i)),n.hide(),s(),t.get().longpoll.push([Object(l.resetPeer)()])}),_e("global_cancel"),(function(){n.hide()}))},this.onChatClose=()=>{var e=this.props,t=e.store,s=e.closePopup,i=t.get().peer,a=Object(R.getTab)(t,i).data.flags,n=a&C.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE?a&~C.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE:a|C.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE,o=Object(te.showFastBox)({title:_e("global_warning"),dark:1},_e("mail_chat_close_confirm"),_e("mail_close_chat"),()=>{this.onUpdateFlags(n).then(()=>{o.hide(),s(),Object(r.isCommunityInterface)(t)||t.get().longpoll.push([Object(l.resetPeer)()])})},_e("global_cancel"),(function(){o.hide()}))},this.onChatRestore=()=>{var e=this.props,t=e.store,s=e.closePopup,i=t.get().peer,a=Object(R.getTab)(t,i).data.flags,n=a&C.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE?a&~C.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE:a|C.MAIL_CHAT_FLAG_DENY_ANYONE_TO_WRITE;this.onUpdateFlags(n).then(s)},this.onResetLink=()=>{var e=this.props.store,t=Object(h.unpackStore)(e),s=t.peer;return Object(o.resetInviteLink)(s,t).then(e=>{var t=le(e,1)[0];this.setState({invitationLinksReseted:!0,invitationLinks:t})})},this.onShowAttachments=()=>{var e=Object(oe.getPeer)(this.props.store);this.props.closePopup(),window.showWiki({w:"history"+Object(r.convertPeerToUrl)(e)+"_photo"},null,{})},this.onLinkHistoryOptionToggle=()=>{var e=Object(oe.getPeer)(this.props.store);this.setState(e=>({isInvitationLinkWithHistory:!e.isInvitationLinkWithHistory}),()=>{this.props.updateHistoryLinkState(e,this.state.isInvitationLinkWithHistory)})},this.state={section:0,invitationLinks:null,invitationLinksReseted:!1,isInvitationLinkWithHistory:this.props.isLinkWithHistorySelected,membersAdded:!1,flagsUpdated:!1,notificationSettingsUpdated:!1,disableUntilUpdated:!1},this.timers=[]}go(e,t){this.setState({section:e},()=>{this.props.updatePopup(),t&&t()})}getPopupTitle(){switch(this.state.section){case 1:return _e("mail_settings_add_members");case 2:case 3:return _e("mail_chat_invite_link");case 6:return _e("mail_settings_options");default:return _e("mail_settings_title")}}componentWillReceiveProps(e){var t=e.store.get(),s=t.peer,i=t.tabs[s];i.photoLarge||i.photoGrid||this.resync||(this.resync=!0,e.store.set(o.getChatDetails.bind(null,s)).then(()=>{this.resync=!0}))}componentDidMount(){this.props.updatePopup()}componentWillUnmount(){this.timers.forEach(clearTimeout)}render(){var e=this.props,t=e.store,s=e.closePopup,i=t.get(),n=i.peer,o=i.tabs[n],l=Object(r.isFvkcomgroup)(t,n),c=Object(R.isCasperChat)(t,n),h=Object(R.isCommunityChat)(t,n),m=!l&&!h||!t.get().gid,g=Object(C.canCloseChat)(t,n,i.id),p=Object(V.isClosedChat)(o),u=i.isChatTypeEditAllowed,v=_e(l?"mail_im_n_vkcomgroup_members":"mail_im_n_chat_members",Object(r.getAliveMembersCount)(o));return a.createElement("section",{className:"ChatSettings"},a.createElement(_.default,{title:this.getPopupTitle(),back:0!==this.state.section?_e("global_back"):void 0,onCloseClick:s,onBackClick:()=>this.go(0)}),0===this.state.section&&a.createElement("div",{className:"ChatSettings__content"},a.createElement(A,{store:t,photo:o.photoLarge,grid:o.photoGrid,title:o.name,flags:o.data.flags,isDefaultPhotoOwner:o.isDefaultPhotoOwner,isCasper:c,meta:v,description:""}),a.createElement(W,{store:t,showMembersSettings:()=>this.go(1),showAttachments:this.onShowAttachments,showInvitationLink:this.showInvitationLink,isInvitationLinkWithHistory:this.state.isInvitationLinkWithHistory,invitationLinks:this.state.invitationLinks,showSettings:()=>this.go(6),notificationSettingsUpdated:this.state.notificationSettingsUpdated,disableUntilUpdated:this.state.disableUntilUpdated,flagsUpdated:this.state.flagsUpdated,onHideStatus:this.onHideStatus,onUpdateNotificationSettings:this.onUpdateNotificationSettings,onUpdateMentionNotificationSettings:this.onUpdateMentionNotificationSettings,afterNotificationSettingsUpdated:this.afterNotificationSettingsUpdated,afterDisableUntilUpdated:this.afterDisableUntilUpdated}),l?null:a.createElement("div",{className:"ChatSettings__pane"},a.createElement($,{store:t,onLeave:this.onLeave,showMembersSettings:()=>this.go(1),membersAdded:this.state.membersAdded,onHideStatus:this.onHideStatus,membersCount:this.state.membersCount})),m&&a.createElement("div",{className:"ChatSettings__pane"},a.createElement(d.default,{appearance:["link","mobile"],className:"ChatSettings__criticalAction ChatSettings__leave",onClick:this.onLeave},_e(l?"mail_leave_channel":"mail_settings_leave"))),g&&!p&&a.createElement("div",{className:"ChatSettings__pane"},a.createElement(d.default,{appearance:["link","mobile"],className:"ChatSettings__criticalAction ChatSettings__close",onClick:this.onChatClose},_e("mail_settings_close"))),g&&p&&a.createElement("div",{className:"ChatSettings__pane"},a.createElement(d.default,{appearance:["link","mobile"],className:"ChatSettings__criticalAction ChatSettings__restore",onClick:this.onChatRestore},_e("mail_settings_restore")))),1===this.state.section&&a.createElement(ne,{store:t,afterSave:this.afterMembersAdded}),6===this.state.section&&a.createElement(re.ChatSettingsOptions,{isChatTypeEditAllowed:u,flags:o.data.flags,isCasperChatTab:c,isCommunityChat:h,allowedUpdateFlags:o.allowedUpdateFlags,back:()=>this.go(0),onSave:this.onUpdateFlags,afterSave:this.afterFlagsUpdated}),2===this.state.section&&a.createElement(E,{store:t,onReset:()=>this.go(3),onLinkHistoryOptionToggle:this.onLinkHistoryOptionToggle,reseted:this.state.invitationLinksReseted,isInvitationLinkWithHistory:this.state.isInvitationLinkWithHistory,invitationLinks:this.state.invitationLinks}),3===this.state.section&&a.createElement(T,{onConfirm:this.onResetLink,onCancel:()=>this.go(2)}))}}function me(e,t){var s=ls.get("im_chats_no_invite_link_history")||[],i=e-2e9,a=t?s.filter(e=>e!==i):s.concat(i);ls.set("im_chats_no_invite_link_history",a)}function ge(e,t){var s=Ce(),i=function(e){var t=Object(oe.getPeer)(e)-2e9;return!(ls.get("im_chats_no_invite_link_history")||[]).includes(t)}(e);s&&n.render(a.createElement(de,{store:e,closePopup:pe.bind(null,e),updatePopup:ue,isLinkWithHistorySelected:i,updateHistoryLinkState:me,parentMutations:t}),s)}function pe(e){he&&he.hide();var t=e.get();t.hasOwnProperty("onClose")&&t.onClose()}function ue(){he&&he.updateBoxCoords()}function Ce(){return document.querySelector("#ChatSettings")}function ve(e){var t=document.querySelector("#box_layer_wrap"),s=document.querySelector("#box_loader"),a=isVisible(t);return{unmount(){var t=Ce();t&&n.unmountComponentAtNode(t),Object(i.destroyModule)(e)},showLoader(){boxRefreshCoords(s),show(s),a||show(t)},hideLoader(){hide(s),a||hide(t)}}}function be(e,t,s){var a=Object(i.createMutations)(ve).bindMutations,n=t.get(),r=Object(i.createModule)({handlers:(e,t)=>{}}),l=n.peer,c=a(r);var _=function(e,t){t.get().peer===l?function(e,t){var s=Object(R.getTab)(e,e.get().peer);s&&s.data&&Object(R.isChatActive)(s)?ge(e,t):pe(e)}(t,s):e.unmount()}.bind(null,c),d={hideButtons:!0,bodyStyle:"padding: 0; background: none;",width:560,onShow(){ge(t,s),t.subscribe(_),requestAnimationFrame(()=>he.updateBoxCoords())},onHideAttempt:()=>(t.unsubscribe(_),c.unmount(),!0)};return c.showLoader(),t.set(o.getChatDetails.bind(null,l)).then(e=>{c.hideLoader();var t=Object(h.unpackStore)(e).peer;t&&t===l?he=new MessageBox(d).content('<div id="ChatSettings" class="ChatSettingsWrapper"></div>').show():c.unmount()}),c}},iukX:function(e,t,s){"use strict";s.r(t),s.d(t,"ChatSettingsOptions",(function(){return v}));s("OEbY");var i=s("q1tI"),a=s("6krn"),n=s("p9ed"),r=s("5R8M"),o=s("hN/p"),l=s("BiHW"),c=s("WfnU"),h=s("0MTP"),_=s("/cSr"),d=(s("17x9"),s("ZxpX")),m=149946368,g=0;class p extends i.Component{constructor(e){super(e),this.selectPreset=(e,t)=>{var s=3===this.state.selectedPresetId&&null!==this.state.customFlags;this.setState(e=>({selectedPresetId:t,customFlags:s?this.props.flags:e.customFlags})),this.props.onSelectPreset(e)};var t=this.props.flags===m?2:this.props.flags===g?1:3;this.state={customFlags:3===t?this.props.flags:null,selectedPresetId:t}}componentWillReceiveProps(e){![g,m].includes(e.flags)&&this.setState({customFlags:e.flags,selectedPresetId:3})}render(){var e=this.state.customFlags?this.state.customFlags:this.props.flags,t=this.state.selectedPresetId,s=[{id:1,title:Object(a.getLang)("mail_chat_creation_preset_regular"),icon:"regular",flags:g},{id:2,title:Object(a.getLang)("mail_chat_creation_preset_closed"),icon:"closed",flags:m},{id:3,title:Object(a.getLang)("mail_chat_creation_preset_custom"),icon:"custom",flags:e}];return i.createElement("div",{className:"ChatSettingsPresetPanel"},s.map((e,s)=>i.createElement("div",{className:Object(d.classNames)("ChatSettingsPresetPanel__preset",{"ChatSettingsPresetPanel__preset--selected":e.id===t}),onClick:this.selectPreset.bind(null,e.flags,e.id),key:s},i.createElement("div",{className:Object(d.classNames)("ChatSettingsPresetPanel__presetIcon","ChatSettingsPresetPanel__presetIcon--"+e.icon)}),i.createElement("div",{className:"ChatSettingsPresetPanel__presetTitle"},e.title))))}}var u=s("sp2a"),C=a.default.getLang;class v extends i.Component{constructor(e){super(e),this.onChange=e=>{var t=e.name,s=e.selected.value;this.setState(e=>({flags:s?e.flags&~t^s:e.flags&~t}))},this.onCancel=()=>{this.setState({flags:this.props.flags}),this.props.back()},this.onSave=()=>{this.state.loading||(this.setState({loading:!0}),this.props.onSave(this.state.flags).then(()=>{this.setState({loading:!1},this.props.afterSave)}).catch(e=>{this.setState({loading:!1,flags:this.props.flags})}))},this.setFlags=e=>{this.setState({flags:e})},this.isAllowed=e=>{var t=this.props.allowedUpdateFlags;return!t||t.includes(e)},this.state={flags:e.flags,loading:!1}}render(){var e=this.state.flags,t=this.props,s=t.isChatTypeEditAllowed,a=t.isCasperChatTab,d=t.isCommunityChat,m=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return[!d&&{value:e,label:C("mail_settings_only_owner")},{value:t,label:C(d?"mail_settings_only_admins":"mail_settings_owner_and_admins")},{value:s,label:C("mail_settings_all_members")}].filter(Boolean)};return i.createElement("div",{className:"ChatSettingsOptions"},this.props.isChatCreation&&i.createElement(p,{flags:e,onSelectPreset:this.setFlags}),i.createElement(n.default,null,(this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE)||this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_INVITE))&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_INVITE+u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE,options:m(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_INVITE,u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE),value:e&(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_INVITE|u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_INVITE)})},i.createElement(_.default,{type:"plus",backgroundColor:"green"}),C("mail_settings_can_invite")),(this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE)||this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CHANGE_TITLE))&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CHANGE_TITLE+u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE,options:m(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CHANGE_TITLE,u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE),value:e&(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CHANGE_TITLE|u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CHANGE_TITLE)})},i.createElement(_.default,{type:"pencil",backgroundColor:"blue"}),C("mail_settings_can_edit_info")),(this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN)||this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN))&&!a&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_PIN+u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN,options:m(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_PIN,u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN),value:e&(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_PIN|u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_PIN)})},i.createElement(_.default,{type:"pin",backgroundColor:"blue"}),C("mail_settings_can_pin")),(this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_MASS_MENTION)||this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_MASS_MENTION))&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_MASS_MENTION+u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_MASS_MENTION,options:m(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_MASS_MENTION,u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_MASS_MENTION),value:e&(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_MASS_MENTION|u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_MASS_MENTION)})},i.createElement(_.default,{type:"mention",backgroundColor:"blue"}),C("mail_settings_can_use_mass_mention")),(this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_SEE_INVITE_LINK)||this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_SEE_INVITE_LINK))&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_SEE_INVITE_LINK+u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_SEE_INVITE_LINK,options:m(0,u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_SEE_INVITE_LINK,u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_SEE_INVITE_LINK),value:e&(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_SEE_INVITE_LINK|u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_SEE_INVITE_LINK)})},i.createElement(_.default,{type:"link",backgroundColor:"blue"}),C("mail_settings_can_see_invitation_link")),(this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CALL)||this.isAllowed(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CALL))&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CALL+u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CALL,options:m(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CALL,u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CALL),value:e&(u.MAIL_CHAT_FLAG_ONLY_OWNER_CAN_CALL|u.MAIL_CHAT_FLAG_ONLY_ADMINS_CAN_CALL)})},i.createElement(_.default,{type:"call",backgroundColor:"green"}),C("mail_settings_can_start_group_call")),this.isAllowed(u.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS)&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__longselect",onChange:this.onChange,name:u.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS,options:[{value:0,label:C("mail_settings_only_owner")},{value:u.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS,label:C("mail_settings_owner_and_admins")}],value:e&u.MAIL_CHAT_FLAG_ADMINS_CAN_ADD_ADMINS})},i.createElement(_.default,{type:"user",backgroundColor:"green"}),C("mail_settings_admins_can_add_admins")),this.isAllowed(u.MAIL_CHAT_FLAG_SERVICE_CHAT)&&s&&i.createElement(r.default,{selectable:!1,aside:i.createElement(o.default,{className:"ChatSettingsOptions__select",onChange:this.onChange,name:u.MAIL_CHAT_FLAG_SERVICE_CHAT,options:[{value:0,label:C("mail_settings_service_simple")},{value:u.MAIL_CHAT_FLAG_SERVICE_CHAT,label:C("mail_settings_service_service")}],value:e&u.MAIL_CHAT_FLAG_SERVICE_CHAT})},i.createElement(_.default,{type:"gear",backgroundColor:"gray"}),C("mail_settings_service"))),i.createElement(h.default,{alignment:"right",className:"ChatSettingsOptions__submitArena"},i.createElement(l.default,{appearance:"tertiary",onClick:this.onCancel},C("global_cancel")),i.createElement(c.default,{onClick:this.onSave,loading:this.state.loading},C("global_save"))))}}}}]);try{stManager.done("cmodules/bundles/902866c362380432bb8fab2a5e67d693.6a0060c400428a307e9e.js")}catch(e){}